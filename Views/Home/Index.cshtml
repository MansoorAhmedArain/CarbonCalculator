@{
    ViewData["Title"] = "Dashboard";
}

<div class="mt-4" style="margin-left:15px;">
    <div class="row">
     <!-- Scope 1 Card -->
<div class="col-md-4 col-sm-12 mb-3">
        <a href="#s1" style="text-decoration: none; color: inherit;">

    <div class="card">
        <div class="card-body d-flex align-items-center">
            <canvas id="scope1Chart" width="70" height="70"></canvas>
            <div class="flex-grow-1 ms-3">
                <h5 class="card-title">Scope 1</h5>
                <p class="card-text">@ViewData["TotalCO2Eq"] ton CO2-eq</p> <!-- Display the total here -->
            </div>
            <div class="ms-auto">
                <i class="fas fa-arrow-right"></i>
            </div>
        </div>
    </div>
    </a>
</div>

        <!-- Scope 2 Card -->
        <div class="col-md-4 col-sm-12 mb-3">
                    <a href="#s2" style="text-decoration: none; color: inherit;">

            <div class="card">
                <div class="card-body d-flex align-items-center">
                    <canvas id="scope2Chart" width="70" height="70"></canvas>
                    <div class="flex-grow-1 ms-3">
                        <h5 class="card-title">Scope 2</h5>
                        <p class="card-text">184.46 ton CO2-eq</p>
                    </div>
                    <div class="ms-auto">
                        <i class="fas fa-arrow-right"></i>
                    </div>
                </div>
            </div>
            </a>
        </div>

        <!-- Scope 3 Card -->
        <div class="col-md-4 col-sm-12 mb-3">
                    <a href="#s3" style="text-decoration: none; color: inherit;">

            <div class="card">
                <div class="card-body d-flex align-items-center">
                    <canvas id="scope3Chart" width="70" height="70"></canvas>
                    <div class="flex-grow-1 ms-3">
                        <h5 class="card-title">Scope 3</h5>
                        <p class="card-text">6.41 ton CO2-eq</p>
                    </div>
                    <div class="ms-auto">
                        <i class="fas fa-arrow-right"></i>
                    </div>
                </div>
            </div>
            </a>
        </div>
    </div>
      <div class="row">
            <!-- Left Section: Donut Chart (col-4) -->
            <div class="col-md-4 col-sm-12 mb-3">
                <div class="card">
                    <div class="total-impact-title" style="padding-left: 5px;">Total Impact</div>
                    <div class="card-body text-center" style="height: 300px; position: relative;">
                        <!-- Canvas for Donut Chart -->
                        <canvas id="totalImpactChart" width="150" height="150"></canvas>
                        <div id="chartCenterText">
                            488.93 <br> ton CO2-eq
                        </div>
                    </div>
                    <div class="d-flex justify-content-around mt-3 text-center" style="gap: 5px;">
                        <div><span class="underline scope-1">Scope 1</span></div>
                        <div><span class="underline scope-2">Scope 2</span></div>
                        <div><span class="underline scope-3">Scope 3</span></div>
                    </div>
                </div>
            </div>

            <!-- Right Section: Table (col-8) -->
          
     <div class="col-md-8 col-sm-12 mb-3">
    <div class="card">
        <div class="card-body" style="height: 300px;"> <!-- Set fixed height -->
            <h5 class="card-title">CO₂ Emissions Over Time</h5>
            <canvas id="emissionsLineChart" style="height: 100%; width: 100%;"></canvas>
        </div>
    </div>
</div>

        </div>
<div class="row">
    <!-- Scope 1 Data Table -->
    <div class="col-md-4 col-sm-12 mb-3">
        <div class="card" id="s1">
            <div class="card-body">
                <h5 class="card-title">Scope 1 </h5>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Mobile Combustion</td>
                            <td>@ViewData["MobileCombustion"]</td>
                        </tr>
                        <tr>
                            <td>Stationary Combustion</td>
                            <td>@ViewData["StationaryCombustion"]</td>
                        </tr>
                        <tr>
                            <td>Process Emission</td>
                            <td>@ViewData["ProcessEmission"]</td>
                        </tr>
                        <tr>
                            <td>Refrigerant Emissions</td>
                            <td>@ViewData["RefrigerantEmissions"]</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Scope 2 Data Table -->
    <div class="col-md-4 col-sm-12 mb-3">
        <div class="card" id="s2">
            <div class="card-body">
                <h5 class="card-title">Scope 2 </h5>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Electricity</td>
                            <td>184.46 ton CO2-eq</td>
                        </tr>
                        <!-- Add more rows as needed -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Scope 3 Data Table -->
    <div class="col-md-4 col-sm-12 mb-3">
        <div class="card"  id="s3">
            <div class="card-body">
                <h5 class="card-title">Scope 3 </h5>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody>
                         <tr>
                            <td>Business Travel and Employee Commuting</td>
                            <td>61.41 ton CO2-eq</td>
                        </tr>
                        <tr>
                            <td>Upstream transportation and distribution</td>
                            <td>6.41 ton CO2-eq</td>
                        </tr>
                        <tr>
                            <td>Waste generated in operations</td>
                            <td>62.41 ton CO2-eq</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const config = (data, colors) => ({
        type: 'doughnut',
        data: {
            datasets: [{
                data: data,
                backgroundColor: colors,
                borderWidth: 1,
                borderColor: '#fff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '65%',
            plugins: {
                legend: {
                    display: false
                }
            },
            layout: {
                padding: 5
            }
        }
    });

    // Retrieve the total CO2 equivalent value
    const totalCO2Eq = @Html.Raw(ViewData["TotalCO2Eq"]); // Ensure this is correctly set in your backend

    const scope1Data = [totalCO2Eq, 1]; // Total CO2-eq for Scope 1
    const scope2Data = [184.46, 1]; // Static value for Scope 2
    const scope3Data = [6.41, 1]; // Static value for Scope 3

    const scope1Colors = ['#1abc9c', '#ecf0f1']; // Green for Scope 1
    const scope2Colors = ['#3498db', '#ecf0f1']; // Blue for Scope 2
    const scope3Colors = ['#e74c3c', '#ecf0f1']; // Red for Scope 3

    // Create charts
    new Chart(document.getElementById('scope1Chart').getContext('2d'), config(scope1Data, scope1Colors));
    new Chart(document.getElementById('scope2Chart').getContext('2d'), config(scope2Data, scope2Colors));
    new Chart(document.getElementById('scope3Chart').getContext('2d'), config(scope3Data, scope3Colors));

    // Total Impact Chart Data
    const totalImpactData = [totalCO2Eq, 184.46, 6.41]; // Include Scope 1 CO2-eq
    const totalImpactColors = ['#1abc9c', '#3498db', '#f1c40f']; // Keep colors consistent

    const totalImpactChartCtx = document.getElementById('totalImpactChart').getContext('2d');
    new Chart(totalImpactChartCtx, config(totalImpactData, totalImpactColors));

    // Define emissions data and labels for line chart
    const emissionsData = {
        labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], // Example months
        datasets: [{
            label: 'CO₂ Emissions',
            data: [50, 60, 45, 80, 70, 90, 100, 85, 60, 55, 75, 65], // Example data points
            borderColor: '#3498db',
            backgroundColor: 'rgba(52, 152, 219, 0.3)',
            fill: true
        }]
    };

    const emissionsConfig = {
    type: 'line',
    data: emissionsData,
    options: {
        responsive: true,
        maintainAspectRatio: false, // Keep this false to respect the container's height
        scales: {
            y: {
                beginAtZero: true,
                title: {
                    display: true,
                    text: "CO₂-eq (ton)"
                }
            },
            x: {
                title: {
                    display: true,
                    text: "Time"
                }
            }
        },
        plugins: {
            legend: {
                display: true,
                position: "top"
            }
        }
    }
};


    // Initialize the line chart
    const emissionsLineChartCtx = document.getElementById('emissionsLineChart').getContext('2d');
    new Chart(emissionsLineChartCtx, emissionsConfig);
</script>

